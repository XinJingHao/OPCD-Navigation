<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ROS Motion Planning: 1、pgm_map_creator &lt;strong&gt;Project Overview&lt;/strong&gt;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ROS Motion Planning
   &#160;<span id="projectnumber">1.0.5</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_src_pgm_map_creator_README.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">1、pgm_map_creator <b>Project Overview</b> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This project is designed to generate PGM maps directly from Gazebo .world files. The generated PGM maps can be used as ground truth maps for testing the performance of SLAM algorithms. Additionally, they can serve as prior global maps for path planning algorithms.</p>
<p>Below are the results generated by the example environment provided by the project.</p>
<p><img src="assets/Example_Environment.png" alt="Example_Environment" class="inline"/></p>
<p align="center"></p>
<p><img src="https://img.shields.io/badge/Ubuntu-20.04-orange?logo=Ubuntu&amp;Ubuntu-20.04" alt="ubuntu" width="100px" height="20px" class="inline"/> <img src="https://img.shields.io/badge/ROS-noetic-blue?logo=ROS&amp;ROS=noetic" alt="ROS" width="100px" height="20px" class="inline"/> </p>
<h1><a class="anchor" id="autotoc_md80"></a>
(1) Features</h1>
<p>① Ground Truth Maps: Create accurate PGM maps for evaluating SLAM algorithm performance. <br  />
</p>
<p>② Prior Global Maps: Utilize the generated maps directly for path planning algorithms. <br  />
</p>
<p>③ High-Quality Mapping: Produce high-quality prior maps for scenarios where SLAM algorithm performance is suboptimal or when using SLAM is inconvenient. <br  />
</p>
<p>④ Convenience and Efficiency: Generate the necessary maps quickly and easily, enhancing the workflow of path planning tasks.</p>
<h1><a class="anchor" id="autotoc_md81"></a>
(2) Use Cases</h1>
<p>① Testing SLAM Algorithms: Evaluate and benchmark the performance of SLAM algorithms using the generated ground truth maps. <br  />
</p>
<p>② Path Planning: Employ the generated PGM maps as prior global maps to improve the efficiency and accuracy of path planning algorithms. <br  />
</p>
<p>③ Challenging Environments: Use this project to generate high-quality global maps in environments where SLAM algorithms may struggle or are impractical to deploy.</p>
<h1><a class="anchor" id="autotoc_md82"></a>
(3) Testing Environment</h1>
<p><b>Ubuntu 20.04, ROS Noetic, Boost 1.71，Gazebo 11, C++ 17</b></p>
<h1><a class="anchor" id="autotoc_md83"></a>
(4) Contribution Details</h1>
<p>This project is based on the open-source <code>pgm_map_creator</code> project by hyfan1116, available at: <a href="https://github.com/hyfan1116/pgm_map_creator">pgm_map_creator</a>. Due to updates in ROS, Boost, and Gazebo versions, the original project is no longer functional. Our main contribution is updating and fixing the project to ensure compatibility with Ubuntu 20.04, ROS Noetic, Boost 1.71, Gazebo 11, and C++ 17, allowing it to run smoothly in these environments. We extend our gratitude to hyfan1116 for the original <code>pgm_map_creator</code> project.</p>
<h1><a class="anchor" id="autotoc_md84"></a>
2、**Project Installation**</h1>
<h2><a class="anchor" id="autotoc_md85"></a>
(1) Install the dependencies.</h2>
<div class="fragment"><div class="line">sudo apt-get update</div>
</div><!-- fragment --><div class="fragment"><div class="line">sudo apt-get install libboost-all-dev protobuf-compiler</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md86"></a>
(2) Clone the Package to your ROS workspace &lt;tt&gt;src&lt;/tt&gt; folder:</h2>
<p><b>Method 1</b>: Use the following command to quickly clone the package. Note that the default ROS workspace name is <code>catkin_ws</code>. If your workspace has a different name, please modify <code>catkin_ws</code> accordingly in the command below.</p>
<div class="fragment"><div class="line">cd ~/catkin_ws/src/</div>
<div class="line">git clone https://github.com/JZX-MY/pgm_map_creator</div>
</div><!-- fragment --><p><b>Method 2</b>: Manually download the project's source code as a zip file, then copy it to your ROS workspace's <code>src</code> folder and extract it.</p>
<h2><a class="anchor" id="autotoc_md87"></a>
(3) Build the Package (First Compilation)</h2>
<p>To ensure the project works correctly, it needs to be compiled twice. First, navigate to your ROS workspace and compile the package:</p>
<div class="fragment"><div class="line">cd ~/catkin_ws/</div>
<div class="line">catkin_make -DCATKIN_WHITELIST_PACKAGES=&quot;pgm_map_creator&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md88"></a>
(4) Modify CMakeLists.txt</h2>
<p>Open the <code>CMakeLists.txt</code> file located in the <code>pgm_map_creator/msgs</code> directory and comment out the following three lines, then save the changes:</p>
<div class="fragment"><div class="line">${PROTOBUF_IMPORT_DIRS}/vector2d.proto</div>
<div class="line">${PROTOBUF_IMPORT_DIRS}/header.proto</div>
<div class="line">${PROTOBUF_IMPORT_DIRS}/time.proto</div>
</div><!-- fragment --><p>The modified <code>CMakeLists.txt</code> file should look like this:</p>
<div class="fragment"><div class="line">find_package(Protobuf REQUIRED)</div>
<div class="line"> </div>
<div class="line">set(PROTOBUF_IMPORT_DIRS)</div>
<div class="line">foreach(ITR ${GAZEBO_INCLUDE_DIRS})</div>
<div class="line">  if(ITR MATCHES &quot;.*gazebo-[0-9.]+$&quot;)</div>
<div class="line">    set(PROTOBUF_IMPORT_DIRS &quot;${ITR}/gazebo/msgs/proto&quot;)</div>
<div class="line">  endif()</div>
<div class="line">endforeach()</div>
<div class="line"> </div>
<div class="line">set (msgs</div>
<div class="line">  collision_map_request.proto</div>
<div class="line">  #${PROTOBUF_IMPORT_DIRS}/vector2d.proto</div>
<div class="line">  #${PROTOBUF_IMPORT_DIRS}/header.proto</div>
<div class="line">  #${PROTOBUF_IMPORT_DIRS}/time.proto</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">PROTOBUF_GENERATE_CPP(PROTO_SRCS PROTO_HDRS ${msgs})</div>
<div class="line">add_library(collision_map_creator_msgs SHARED ${PROTO_SRCS})</div>
<div class="line">target_include_directories(collision_map_creator_msgs PUBLIC ${PROTOBUF_INCLUDE_DIRS})</div>
<div class="line">target_link_libraries(collision_map_creator_msgs ${PROTOBUF_LIBRARY})</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md89"></a>
(5) Build the Project (Second Compilation)</h2>
<p>After modifying the <code>CMakeLists.txt</code> file, perform the second compilation:</p>
<div class="fragment"><div class="line">catkin_make -DCATKIN_WHITELIST_PACKAGES=&quot;pgm_map_creator&quot;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md90"></a>
3、**Verify if the Package is Functioning Correctly.**</h1>
<p>To verify if the package is functioning correctly, please execute the following two commands in sequence for testing.</p>
<div class="fragment"><div class="line">roslaunch pgm_map_creator open_world.launch</div>
</div><!-- fragment --><div class="fragment"><div class="line">roslaunch pgm_map_creator request_publisher.launch</div>
</div><!-- fragment --><p>After the program runs successfully, a file named <code>map.pgm</code> will be generated in the <code>maps</code> folder, as shown in the dynamic demonstration of the testing process below:</p>
<div align="center"> <img src="assets/testgif.gif" alt="testgif.gif" class="inline"/> </div><p>Note that the example environment mentioned above includes some third-party models. If these models are not downloaded on your computer, the Gazebo environment you open may be missing some parts compared to the illustrations above. Additionally, since the system may keep searching for the missing files, the time taken to open Gazebo could be longer. Taking this into consideration, we have added a new, simpler test example that does not include any third-party models, named 'test2.world'. Additionally, we have changed the default test file to this new file,as shown in the dynamic demonstration of the testing process below:.</p>
<p><img src="assets/Example_Environment2.png" alt="Example_Environment2" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md91"></a>
4、**How to Use in Your Own .World File**</h1>
<h2><a class="anchor" id="autotoc_md92"></a>
(1) Copy your &lt;tt&gt;.world&lt;/tt&gt; file to the &lt;tt&gt;worlds&lt;/tt&gt; folder of the &lt;tt&gt;pgm_map_creator&lt;/tt&gt; package.</h2>
<h2><a class="anchor" id="autotoc_md93"></a>
(2) Add the plugin to the .world file.</h2>
<p>Add the following code to your own <code>.world</code> file, just before the <code>&lt;/world&gt;</code> tag.</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">plugin</span> <span class="keyword">filename</span>=<span class="stringliteral">&quot;libcollision_map_creator.so&quot;</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;collision_map_creator&quot;</span>/&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md94"></a>
(3) Modify the &lt;tt&gt;open_world.launch&lt;/tt&gt; file</h2>
<p>Open the <code>open_world.launch</code> file in the <code>launch</code> folder of the <code>pgm_map_creator</code> package, and change the referenced <code>.world</code> file to your own <code>.world</code> file. Replace <code>test.world</code> in the following line with the name of your own <code>.world</code> file and save the changes:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">arg</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;world_file&quot;</span> <span class="keyword">default</span>=<span class="stringliteral">&quot;$(find pgm_map_creator)/worlds/test.world&quot;</span>/&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md95"></a>
(4) Modify the &lt;tt&gt;request_publisher.launch&lt;/tt&gt; file</h2>
<p>Open the <code>request_publisher.launch</code> file in the <code>launch</code> folder of the <code>pgm_map_creator</code> package. Based on your <code>.world</code> file, set the relevant parameters for the mapping area range: <code>xmin</code>, <code>xmax</code>, <code>ymin</code>, <code>ymax</code>, and the map resolution <code>resolution</code>. The commonly used default value for resolution is 0.05.</p>
<h2><a class="anchor" id="autotoc_md96"></a>
(5) Use the &lt;tt&gt;pgm_map_creator&lt;/tt&gt; package to generate the map</h2>
<p>After making the above modifications, you can now execute the following two commands sequentially to generate the pgm map file for your own <code>.world</code> file:</p>
<div class="fragment"><div class="line">roslaunch pgm_map_creator open_world.launch</div>
</div><!-- fragment --><div class="fragment"><div class="line">roslaunch pgm_map_creator request_publisher.launch</div>
</div><!-- fragment --><p>Wait for the plugin th generate map. Track the progess in the terminal that spawns the world file. Once it is done, the pgm map would be in the <code>maps</code> folder of the <code>pgm_map_creator</code>.</p>
<h2><a class="anchor" id="autotoc_md97"></a>
(6) Create the &lt;tt&gt;yaml&lt;/tt&gt; file for the pgm map.</h2>
<p>You may also need a <code>yaml</code> file which provides the metadata of the map.</p>
<div class="fragment"><div class="line">cd catkin_ws/src/pgm_map_creator/maps</div>
<div class="line">touch map.yaml</div>
</div><!-- fragment --><p><code>map.yaml</code> </p><div class="fragment"><div class="line">image: map.pgm</div>
<div class="line">resolution: 0.01</div>
<div class="line">origin: [-5.0, -12.0, 0.0]</div>
<div class="line">occupied_thresh: 0.65</div>
<div class="line">free_thresh: 0.196</div>
<div class="line">negate: 0</div>
</div><!-- fragment --><p>The parameters <code>resolution</code> and <code>origin</code> are based on the arguments in <code>request_publisher.launch</code>.The <code>image</code> parameter is the name of the map generated in the previous step. If you manually renamed the map, you need to update this parameter accordingly. In our provided example, it has been manually renamed to <code>test.pgm</code>. Alternatively, you can modify the <code>map_name</code> parameter in the <code>request_publisher.launch</code> file to directly generate a pgm map with the specified name.</p>
<h1><a class="anchor" id="autotoc_md98"></a>
5、**Acknowledgments**</h1>
<p>This project is based on the open-source <code>pgm_map_creator</code> project by hyfan1116, available at: <a href="https://github.com/hyfan1116/pgm_map_creator">pgm_map_creator</a>. Due to updates in ROS, Boost, and Gazebo versions, the original project is no longer functional. Our main contribution is updating and fixing the project to ensure compatibility with Ubuntu 20.04, ROS Noetic, Boost 1.71, Gazebo 11, and C++ 17, allowing it to run smoothly in these environments. We extend our gratitude to hyfan1116 for the original <code>pgm_map_creator</code> project. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
